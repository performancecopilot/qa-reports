UID          PID    PPID  C STIME TTY          TIME CMD 
pcp       467917       1  0 19:13 ?        00:00:00 /usr/libexec/pcp/bin/pmcd -A -T 3 -C 512 
root      467921  467917  0 19:13 ?        00:00:00 /tmp/169-467363.dumb_pmda -d 160 000000660066 
root      467932       1  0 19:13 ?        00:00:00 /usr/bin/sh /usr/libexec/pcp/lib/pmcd restart 
old_dumb_pid=467921
old_pmcd_pid=467917

*** pmcd agent timeout < app timeout ***
*** pmcd will killoff agent ***


Expect dummyproc to fail (IPC protocol failure):

UID          PID    PPID  C STIME TTY          TIME CMD 
pcp       467917       1  0 19:13 ?        00:00:00 /usr/libexec/pcp/bin/pmcd -A -T 3 -C 512 
new_dumb_pid=
new_pmcd_pid=467917
pmcd terminated dummy the dumb_pmda agent as desired

Log for pmcd on c8e83635332f started Sat Feb  7 19:13:20 2026


active agent dom   pid  in out ver protocol parameters
============ === ===== === === === ======== ==========
dummyproc    160 467921   6   7   2 bin pipe cmd=/tmp/169-467363.dumb_pmda -d 160 000000660066
pmcd           2                 4 dso i:6  lib=/var/lib/pcp/pmdas/pmcd/pmda_pmcd.so entry=pmcd_init [0x7fd79ad53b60]

Host access list empty: host-based access control turned off
User access list empty: user-based access control turned off
Group access list empty: group-based access control turned off


pmcd: PID = 467917, PDU version = 2
pmcd request port(s):
  sts fd   port  family address
  === ==== ===== ====== =======
  ok     4       unix   /run/pcp/pmcd.socket
  ok     0 44321 inet   INADDR_ANY
  ok     3 44321 ipv6   INADDR_ANY
[Sat Feb  7 19:13:25] pmcd(467917) Warning: pduread: timeout (after 5.000000 sec) while attempting to read 12 bytes out of 12 in HDR on fd=7
[Sat Feb  7 19:13:25] pmcd(467917) Info: CleanupAgent ...
Cleanup "dummyproc" agent (dom 160): protocol failure for fd=7, exit(0)

->PMCD event trace: starting at Sat Feb  7 19:13:20 2026
->         Recv: CREDS PDU, fd=5, pdubuf=0x...1
->         Recv: PMNS_NAMES PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: PMNS_IDS PDU, fd=5, numpmid=1
->         Recv: DESC_REQ PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: DESC PDU, fd=5, pmid=2.0.4
->         Recv: PROFILE PDU, fd=5, pdubuf=0x...234599c0
->         Recv: HIGHRES_FETCH PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: HIGHRES_FETCH PDU, fd=5, numpmid=1
->         Recv: RESULT PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: ERROR PDU, fd=5, err=0: No error
->         End client: [0] fd=5
->         Xmit: ERROR PDU, fd=6, err=-12391: Not Connected
->         New client: [0] addr=/run/pcp/pmcd.socket, fd=5, seq=5
->         Xmit: ERROR PDU, fd=5, err=0: No error
->         Recv: CREDS PDU, fd=5, pdubuf=0x...234599c0
->         Recv: CREDS PDU, fd=5, pdubuf=0x...1
->         Recv: DESC_REQ PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: DESC_REQ PDU, fd=6, pmid=160.0.0
->19:13:25 Wrong PDU type: expecting DESC PDU, fd=7, got err=-12353: Timeout waiting for a response from PMCD
->         Drop PMDA: domain=160, infd=6, outfd=7

Warning: restartAgents=0 from PMCD_RESTART_AGENTS=0 in environment

Log for 169-467363.dumb_pmda on c8e83635332f started Sat Feb  7 19:13:20 2026


Log finished Sat Feb  7 19:13:25 2026

UID          PID    PPID  C STIME TTY          TIME CMD 
pcp       467917       1  0 19:13 ?        00:00:00 /usr/libexec/pcp/bin/pmcd -A -T 3 -C 512 
pcp       468146  467917  0 19:13 ?        00:00:00 /tmp/169-467363.dumb_pmda -d 160 000000660066 
new_dumb_pid=468146
new_pmcd_pid=467917

*** pmcd agent timeout > app timeout ***
*** pmcd will not killoff agent until later ***


Expect dummyproc to fail (timeout for pmcd failure):
Before pminfo: Sat Feb  7 19:13:28 UTC 2026
After pminfo: Sat Feb  7 19:13:33 UTC 2026

UID          PID    PPID  C STIME TTY          TIME CMD 
pcp       467917       1  0 19:13 ?        00:00:00 /usr/libexec/pcp/bin/pmcd -A -T 3 -C 512 
pcp       468146  467917  0 19:13 ?        00:00:00 /tmp/169-467363.dumb_pmda -d 160 000000660066 
new_dumb_pid=468146
new_pmcd_pid=467917
pmcd did NOT terminate the dumb_pmda agent as desired

Now wait for pmcd to timeout...

UID          PID    PPID  C STIME TTY          TIME CMD 
pcp       467917       1  0 19:13 ?        00:00:00 /usr/libexec/pcp/bin/pmcd -A -T 3 -C 512 
new_dumb_pid=
new_pmcd_pid=467917
pmcd terminated the dumb_pmda agent as desired

_wait_pmcd_end: pid 467917 is defunct
systemd,1
  `-pmcd,467917,pcp -A -T 3 -C 512

Log for pmcd on c8e83635332f started Sat Feb  7 19:13:20 2026


active agent dom   pid  in out ver protocol parameters
============ === ===== === === === ======== ==========
dummyproc    160 467921   6   7   2 bin pipe cmd=/tmp/169-467363.dumb_pmda -d 160 000000660066
pmcd           2                 4 dso i:6  lib=/var/lib/pcp/pmdas/pmcd/pmda_pmcd.so entry=pmcd_init [0x7fd79ad53b60]

Host access list empty: host-based access control turned off
User access list empty: user-based access control turned off
Group access list empty: group-based access control turned off


pmcd: PID = 467917, PDU version = 2
pmcd request port(s):
  sts fd   port  family address
  === ==== ===== ====== =======
  ok     4       unix   /run/pcp/pmcd.socket
  ok     0 44321 inet   INADDR_ANY
  ok     3 44321 ipv6   INADDR_ANY
[Sat Feb  7 19:13:25] pmcd(467917) Warning: pduread: timeout (after 5.000000 sec) while attempting to read 12 bytes out of 12 in HDR on fd=7
[Sat Feb  7 19:13:25] pmcd(467917) Info: CleanupAgent ...
Cleanup "dummyproc" agent (dom 160): protocol failure for fd=7, exit(0)

->PMCD event trace: starting at Sat Feb  7 19:13:20 2026
->         Recv: CREDS PDU, fd=5, pdubuf=0x...1
->         Recv: PMNS_NAMES PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: PMNS_IDS PDU, fd=5, numpmid=1
->         Recv: DESC_REQ PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: DESC PDU, fd=5, pmid=2.0.4
->         Recv: PROFILE PDU, fd=5, pdubuf=0x...234599c0
->         Recv: HIGHRES_FETCH PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: HIGHRES_FETCH PDU, fd=5, numpmid=1
->         Recv: RESULT PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: ERROR PDU, fd=5, err=0: No error
->         End client: [0] fd=5
->         Xmit: ERROR PDU, fd=6, err=-12391: Not Connected
->         New client: [0] addr=/run/pcp/pmcd.socket, fd=5, seq=5
->         Xmit: ERROR PDU, fd=5, err=0: No error
->         Recv: CREDS PDU, fd=5, pdubuf=0x...234599c0
->         Recv: CREDS PDU, fd=5, pdubuf=0x...1
->         Recv: DESC_REQ PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: DESC_REQ PDU, fd=6, pmid=160.0.0
->19:13:25 Wrong PDU type: expecting DESC PDU, fd=7, got err=-12353: Timeout waiting for a response from PMCD
->         Drop PMDA: domain=160, infd=6, outfd=7

Warning: restartAgents=0 from PMCD_RESTART_AGENTS=0 in environment
[Sat Feb  7 19:13:27] pmcd(467917) Info: 

pmcd RESTARTED at Sat Feb  7 19:13:27 2026


Current PMCD clients ...
     fd  client connection from                    ipc ver  operations denied
     ==  ========================================  =======  =================

Configuration file '/etc/pcp/pmcd/pmcd.conf' unchanged
Restarting any deceased agents:
    "dummyproc" agent


active agent dom   pid  in out ver protocol parameters
============ === ===== === === === ======== ==========
dummyproc    160 468146   6   7   2 bin pipe cmd=/tmp/169-467363.dumb_pmda -d 160 000000660066
pmcd           2                 4 dso i:6  lib=/var/lib/pcp/pmdas/pmcd/pmda_pmcd.so entry=pmcd_init [0x7fd79ad53b60]

Host access list empty: host-based access control turned off
User access list empty: user-based access control turned off
Group access list empty: group-based access control turned off

[Sat Feb  7 19:13:27] pmcd(467917) Info: PMNS file "DEFAULT" is unchanged
[Sat Feb  7 19:13:38] pmcd(467917) Warning: pduread: timeout (after 10.000000 sec) while attempting to read 12 bytes out of 12 in HDR on fd=7
[Sat Feb  7 19:13:38] pmcd(467917) Info: CleanupAgent ...
Cleanup "dummyproc" agent (dom 160): protocol failure for fd=7, exit(0)

->PMCD event trace: starting at Sat Feb  7 19:13:28 2026
->         Recv: CREDS PDU, fd=5, pdubuf=0x...1
->         Recv: PMNS_NAMES PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: PMNS_IDS PDU, fd=5, numpmid=1
->         Recv: DESC_REQ PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: DESC PDU, fd=5, pmid=2.0.4
->         Recv: PROFILE PDU, fd=5, pdubuf=0x...2345a520
->         Recv: HIGHRES_FETCH PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: HIGHRES_FETCH PDU, fd=5, numpmid=1
->         Recv: RESULT PDU, fd=5, pdubuf=0x...2345a520
->         Xmit: ERROR PDU, fd=5, err=0: No error
->         End client: [0] fd=5
->         Xmit: ERROR PDU, fd=6, err=-12391: Not Connected
->         New client: [0] addr=/run/pcp/pmcd.socket, fd=5, seq=10
->         Xmit: ERROR PDU, fd=5, err=0: No error
->         Recv: CREDS PDU, fd=5, pdubuf=0x...234599c0
->         Recv: CREDS PDU, fd=5, pdubuf=0x...1
->         Recv: DESC_REQ PDU, fd=5, pdubuf=0x...234599c0
->         Xmit: DESC_REQ PDU, fd=6, pmid=160.0.0
->19:13:38 Wrong PDU type: expecting DESC PDU, fd=7, got err=-12353: Timeout waiting for a response from PMCD
->         Drop PMDA: domain=160, infd=6, outfd=7

[Sat Feb  7 19:13:38] pmcd(467917) Error: HandleClientInput: error sending Error PDU to client[0] IPC protocol failure

Log for 169-467363.dumb_pmda on c8e83635332f started Sat Feb  7 19:13:20 2026


Log finished Sat Feb  7 19:13:25 2026
_wait_for_pmlogger() success at iter 1 ...
Connected to primary pmlogger at local:
pmlogger [primary] on host local: is logging metrics from host c8e83635332f
PMCD host        c8e83635332f
log started      Sat Feb  7 19:13:55.664404611 2026 (times in local time)
last log entry   Sat Feb  7 19:13:56.157187401 2026
current time     Sat Feb  7 19:13:57.140007033 2026
log volume       0
log size         66960
