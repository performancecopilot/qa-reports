key_server_node1_port=54321
__key_server_node1_pid=1741708
key_server_node2_port=54322
__key_server_node2_pid=1741725
key_server_node3_port=54323
__key_server_node3_pid=1741745
>>> Performing hash slots allocation on 3 nodes...
Primary[0] -> Slots 0 - 5460
Primary[1] -> Slots 5461 - 10922
Primary[2] -> Slots 10923 - 16383
M: 7be343ec1dcc2c68501a65d912dd1e31e07e9409 127.0.0.1:54321
   slots:[0-5460] (5461 slots) master
M: 918441748cc773af821ab804c9db4e08dc5ca960 127.0.0.1:54322
   slots:[5461-10922] (5462 slots) master
M: 1bc14953fde168905ebb1f15db0d8f0e58ce32a8 127.0.0.1:54323
   slots:[10923-16383] (5461 slots) master
Can I set the above configuration? (type 'yes' to accept): >>> Nodes configuration updated
>>> Assign a different config epoch to each node
>>> Sending CLUSTER MEET messages to join the cluster
Waiting for the cluster to join

>>> Performing Cluster Check (using node 127.0.0.1:54321)
M: 7be343ec1dcc2c68501a65d912dd1e31e07e9409 127.0.0.1:54321
   slots:[0-5460] (5461 slots) master
M: 918441748cc773af821ab804c9db4e08dc5ca960 127.0.0.1:54322
   slots:[5461-10922] (5462 slots) master
M: 1bc14953fde168905ebb1f15db0d8f0e58ce32a8 127.0.0.1:54323
   slots:[10923-16383] (5461 slots) master
[OK] All nodes agree about slots configuration.
>>> Check for open slots...
>>> Check slots coverage...
[OK] All 16384 slots covered.
key_server_node1_port=54321
key_server_node2_port=54322
key_server_node3_port=54323
proxyport=54324
pmproxy_pid=1741825
connect: Connection refused
exit: 1
exit: 0
tcp        0      0 0.0.0.0:54323           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:54322           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:54321           0.0.0.0:*               LISTEN     
tcp6       0      0 [::]:54323              [::]:*                  LISTEN     
tcp6       0      0 [::]:54322              [::]:*                  LISTEN     
tcp6       0      0 [::]:54321              [::]:*                  LISTEN     
tcp6       0      0 [::]:54324              [::]:*                  LISTEN     
[pmproxy]
pcp.enabled = true
resp.enabled = true
[pmseries]
servers = localhost:54321,localhost:54322,localhost:54323
Log for pmproxy on b45c2366e4f3 started Wed Oct 22 20:52:40 2025

[Wed Oct 22 20:52:40] pmproxy(1741825) Error: pmWebTimerSetMetricRegistry: server instrumentation disabled
[Wed Oct 22 20:52:40] pmproxy(1741825) Error: pmproxy: open_request_local - uv_pipe_bind /run/pcp/pmproxy.socket failed [EACCES]: permission denied
[Wed Oct 22 20:52:40] pmproxy(1741825) Error: pmproxy: open_request_port - uv_listen failed port=54324 [EADDRINUSE]: address already in use
pmproxy: PID = 1741825, PDU version = 2, user = pcpqa (994)
pmproxy request port(s):
  sts fd   port  family address
  === ==== ===== ====== =======
  err   -1       unix   /run/pcp/pmproxy.socket
  err   -1 54324 inet   INADDR_ANY
  ok    11 54324 ipv6   INADDR_ANY
[Wed Oct 22 20:52:40] pmproxy(1741825) Info: Key server slots, command keys setup
== all done

== Key server Node 1 keys:


== Key server Node 1 log:
1741708:C 22 Oct 2025 20:52:37.101 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
1741708:C 22 Oct 2025 20:52:37.101 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
1741708:C 22 Oct 2025 20:52:37.101 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
1741708:C 22 Oct 2025 20:52:37.101 * Valkey version=8.0.4, bits=64, commit=00000000, modified=1, pid=1741708, just started
1741708:C 22 Oct 2025 20:52:37.101 * Configuration loaded
1741708:M 22 Oct 2025 20:52:37.101 * monotonic clock: POSIX clock_gettime
1741708:M 22 Oct 2025 20:52:37.101 * Running mode=cluster, port=54321.
1741708:M 22 Oct 2025 20:52:37.102 * No cluster configuration found, I'm 7be343ec1dcc2c68501a65d912dd1e31e07e9409
1741708:M 22 Oct 2025 20:52:37.103 * Server initialized
1741708:M 22 Oct 2025 20:52:37.103 * Ready to accept connections tcp
1741708:M 22 Oct 2025 20:52:37.931 * configEpoch set to 1 via CLUSTER SET-CONFIG-EPOCH
1741708:M 22 Oct 2025 20:52:37.965 * IP address for this node updated to 127.0.0.1
1741708:M 22 Oct 2025 20:52:39.113 * Cluster state changed: ok

== Key server Node 2 keys:


== Key server Node 2 log:
1741725:C 22 Oct 2025 20:52:37.377 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
1741725:C 22 Oct 2025 20:52:37.377 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
1741725:C 22 Oct 2025 20:52:37.377 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
1741725:C 22 Oct 2025 20:52:37.377 * Valkey version=8.0.4, bits=64, commit=00000000, modified=1, pid=1741725, just started
1741725:C 22 Oct 2025 20:52:37.377 * Configuration loaded
1741725:M 22 Oct 2025 20:52:37.378 * monotonic clock: POSIX clock_gettime
1741725:M 22 Oct 2025 20:52:37.378 * Running mode=cluster, port=54322.
1741725:M 22 Oct 2025 20:52:37.378 * No cluster configuration found, I'm 918441748cc773af821ab804c9db4e08dc5ca960
1741725:M 22 Oct 2025 20:52:37.379 * Server initialized
1741725:M 22 Oct 2025 20:52:37.380 * Ready to accept connections tcp
1741725:M 22 Oct 2025 20:52:37.931 * configEpoch set to 2 via CLUSTER SET-CONFIG-EPOCH
1741725:M 22 Oct 2025 20:52:38.008 * IP address for this node updated to 127.0.0.1
1741725:M 22 Oct 2025 20:52:38.008 * Successfully completed handshake with 7be343ec1dcc2c68501a65d912dd1e31e07e9409 ()
1741725:M 22 Oct 2025 20:52:39.388 * Cluster state changed: ok

== Key server Node 3 keys:


== Key server Node 3 log:
1741745:C 22 Oct 2025 20:52:37.661 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
1741745:C 22 Oct 2025 20:52:37.661 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
1741745:C 22 Oct 2025 20:52:37.661 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
1741745:C 22 Oct 2025 20:52:37.661 * Valkey version=8.0.4, bits=64, commit=00000000, modified=1, pid=1741745, just started
1741745:C 22 Oct 2025 20:52:37.661 * Configuration loaded
1741745:M 22 Oct 2025 20:52:37.662 * monotonic clock: POSIX clock_gettime
1741745:M 22 Oct 2025 20:52:37.662 * Running mode=cluster, port=54323.
1741745:M 22 Oct 2025 20:52:37.662 * No cluster configuration found, I'm 1bc14953fde168905ebb1f15db0d8f0e58ce32a8
1741745:M 22 Oct 2025 20:52:37.663 * Server initialized
1741745:M 22 Oct 2025 20:52:37.663 * Ready to accept connections tcp
1741745:M 22 Oct 2025 20:52:37.931 * configEpoch set to 3 via CLUSTER SET-CONFIG-EPOCH
1741745:M 22 Oct 2025 20:52:38.008 * IP address for this node updated to 127.0.0.1
1741745:M 22 Oct 2025 20:52:38.008 * Successfully completed handshake with 7be343ec1dcc2c68501a65d912dd1e31e07e9409 ()
1741745:M 22 Oct 2025 20:52:39.673 * Cluster state changed: ok
