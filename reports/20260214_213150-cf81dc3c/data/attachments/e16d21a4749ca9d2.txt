_wait_proxy_end: pid 1614896 is defunct
systemd,1
  `-pmcd,1614896,pcp -A -T 3 -C 512
      `-pmdaroot,1614899,root
          |-pmdadm,1614909 -d 129
          |-pmdakvm,1614908 -d 95
          |-pmdalinux,1614903
          |-pmdaproc,1614900 -d 3
          |-pmdasample,1614902,pcp -d 29
          |-pmdasimple,1614923,pcp -d 253
          |-pmdaxfs,1614901 -d 11
          |-python3,1614904 /var/lib/pcp/pmdas/nfsclient/pmdanfsclient.python
          |-python3,1614914 /var/lib/pcp/pmdas/opentelemetry/pmdaopentelemetry.python
          `-python3,1614910,pcp /var/lib/pcp/pmdas/openmetrics/pmdaopenmetrics.python
key_server_node1_port=54321
__key_server_node1_pid=1627467
key_server_node2_port=54322
__key_server_node2_pid=1627484
key_server_node3_port=54322
__key_server_node3_pid=1627519
>>> Performing hash slots allocation on 3 node(s)...
Primary[0] -> Slots 0 - 5460
Primary[1] -> Slots 5461 - 10922
Primary[2] -> Slots 10923 - 16383
>>> Trying to optimize replicas allocation for anti-affinity
[WARNING] Some replicas are in the same host as their primary
M: 55bb2204157c9eae069896e717e165c0db3098f9 127.0.0.1:54321
   slots:[0-5460] (5461 slots) master
M: c6642cf3a0b0b12be7543e576205e01b8dd581d2 127.0.0.1:54322
   slots:[5461-10922] (5462 slots) master
M: c6642cf3a0b0b12be7543e576205e01b8dd581d2 127.0.0.1:54322
   slots:[10923-16383] (5461 slots) master
Can I set the above configuration? (type 'yes' to accept): >>> Nodes configuration updated
>>> Assign a different config epoch to each node
>>> Sending CLUSTER MEET messages to join the cluster
Waiting for the cluster to join

>>> Performing Cluster Check (using node 127.0.0.1:54321)
M: 55bb2204157c9eae069896e717e165c0db3098f9 127.0.0.1:54321
   slots:[0-5460] (5461 slots) master
M: c6642cf3a0b0b12be7543e576205e01b8dd581d2 127.0.0.1:54322
   slots:[5461-16383] (10923 slots) master
[OK] All nodes agree about slots configuration.
>>> Check for open slots...
>>> Check slots coverage...
[OK] All 16384 slots covered.
key_server_node1_port=54321
key_server_node2_port=54322
key_server_node3_port=54322
proxyport=54323
pmproxy_pid=1627559
connect: Connection refused
exit: 1
exit: 0
tcp        0      0 0.0.0.0:54321           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:54322           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:54323           0.0.0.0:*               LISTEN     
tcp6       0      0 [::]:54321              [::]:*                  LISTEN     
tcp6       0      0 [::]:54322              [::]:*                  LISTEN     
tcp6       0      0 [::]:54323              [::]:*                  LISTEN     
[pmproxy]
pcp.enabled = true
resp.enabled = true
[pmseries]
servers = localhost:54321,localhost:54322,localhost:54322
Log for pmproxy on 364cbb0d37f9 started Sat Feb 14 21:03:18 2026

[Sat Feb 14 21:03:18] pmproxy(1627559) Error: pmWebTimerSetMetricRegistry: server instrumentation disabled
[Sat Feb 14 21:03:18] pmproxy(1627559) Error: pmproxy: open_request_local - uv_pipe_bind /run/pcp/pmproxy.socket failed [EACCES]: permission denied
pmproxy: PID = 1627559, PDU version = 2, user = pcpqa (994)
pmproxy request port(s):
  sts fd   port  family address
  === ==== ===== ====== =======
  err   -1       unix   /run/pcp/pmproxy.socket
  ok    11 54323 inet   INADDR_ANY
  ok    12 54323 ipv6   INADDR_ANY
[Sat Feb 14 21:03:18] pmproxy(1627559) Info: Key server slots, command keys setup
[Sat Feb 14 21:03:19] pmproxy(1627559) Error: keySlotsRequest: Failed to find keys of command GET (*4
$3
get
$3
foo
$3
bar
$3
baz
)
== all done

== Key server Node 1 keys:


== Key server Node 1 log:
1627467:M 14 Feb 2026 21:03:10.794 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
1627467:M 14 Feb 2026 21:03:10.794 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
1627467:M 14 Feb 2026 21:03:10.794 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
1627467:M 14 Feb 2026 21:03:10.794 * Valkey version=8.1.1, bits=64, commit=00000000, modified=0, pid=1627467, just started
1627467:M 14 Feb 2026 21:03:10.794 * Configuration loaded
1627467:M 14 Feb 2026 21:03:10.795 * monotonic clock: POSIX clock_gettime
1627467:M 14 Feb 2026 21:03:10.795 * Running mode=cluster, port=54321.
1627467:M 14 Feb 2026 21:03:10.795 * No cluster configuration found, I'm 55bb2204157c9eae069896e717e165c0db3098f9
1627467:M 14 Feb 2026 21:03:10.796 * Server initialized
1627467:M 14 Feb 2026 21:03:10.796 * Ready to accept connections tcp
1627467:M 14 Feb 2026 21:03:12.802 # Cluster is currently down: I am part of a minority partition.
1627467:M 14 Feb 2026 21:03:13.729 # Cluster is currently down: At least one hash slot is not served by any available node. Please check the 'cluster-require-full-coverage' configuration.
1627467:M 14 Feb 2026 21:03:13.732 * configEpoch set to 1 via CLUSTER SET-CONFIG-EPOCH
1627467:M 14 Feb 2026 21:03:13.754 * IP address for this node updated to 127.0.0.1
1627467:M 14 Feb 2026 21:03:18.727 * Cluster state changed: ok

== Key server Node 2 keys:
pcpqa:1602:one
pcpqa:1602:ten

== Key server Node 2 log:
1627484:M 14 Feb 2026 21:03:11.081 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
1627484:M 14 Feb 2026 21:03:11.081 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
1627484:M 14 Feb 2026 21:03:11.081 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
1627484:M 14 Feb 2026 21:03:11.081 * Valkey version=8.1.1, bits=64, commit=00000000, modified=0, pid=1627484, just started
1627484:M 14 Feb 2026 21:03:11.081 * Configuration loaded
1627484:M 14 Feb 2026 21:03:11.082 * monotonic clock: POSIX clock_gettime
1627484:M 14 Feb 2026 21:03:11.082 * Running mode=cluster, port=54322.
1627484:M 14 Feb 2026 21:03:11.082 * No cluster configuration found, I'm d2b43da0e9444e486153ae464a513cdc995824a6
1627484:M 14 Feb 2026 21:03:11.083 # Warning: Could not create server TCP listening socket *:54322: bind: Address already in use
1627484:M 14 Feb 2026 21:03:11.083 # Failed listening on port 54322 (tcp), aborting.

== Key server Node 3 keys:
pcpqa:1602:one
pcpqa:1602:ten

== Key server Node 3 log:
1627519:M 14 Feb 2026 21:03:13.451 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
1627519:M 14 Feb 2026 21:03:13.451 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
1627519:M 14 Feb 2026 21:03:13.451 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
1627519:M 14 Feb 2026 21:03:13.451 * Valkey version=8.1.1, bits=64, commit=00000000, modified=0, pid=1627519, just started
1627519:M 14 Feb 2026 21:03:13.451 * Configuration loaded
1627519:M 14 Feb 2026 21:03:13.452 * monotonic clock: POSIX clock_gettime
1627519:M 14 Feb 2026 21:03:13.452 * Running mode=cluster, port=54322.
1627519:M 14 Feb 2026 21:03:13.452 * No cluster configuration found, I'm c6642cf3a0b0b12be7543e576205e01b8dd581d2
1627519:M 14 Feb 2026 21:03:13.453 * Server initialized
1627519:M 14 Feb 2026 21:03:13.453 * Ready to accept connections tcp
1627519:M 14 Feb 2026 21:03:13.732 * configEpoch set to 2 via CLUSTER SET-CONFIG-EPOCH
1627519:M 14 Feb 2026 21:03:13.733 * Cluster meet 127.0.0.1:54321 (user request from 'id=5 addr=127.0.0.1:60554 laddr=127.0.0.1:54322 fd=13 name=*redacted* user=*redacted* lib-name= lib-ver=').
1627519:M 14 Feb 2026 21:03:13.733 * Cluster meet 127.0.0.1:54321 (user request from 'id=6 addr=127.0.0.1:60560 laddr=127.0.0.1:54322 fd=14 name=*redacted* user=*redacted* lib-name= lib-ver=').
1627519:M 14 Feb 2026 21:03:13.805 * IP address for this node updated to 127.0.0.1
1627519:M 14 Feb 2026 21:03:13.805 * Successfully completed handshake with 55bb2204157c9eae069896e717e165c0db3098f9 ()
1627519:M 14 Feb 2026 21:03:15.459 * Cluster state changed: ok
